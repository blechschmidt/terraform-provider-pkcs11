---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "pkcs11_wrapped_key Resource - pkcs11"
subcategory: ""
description: |-
  Wraps (exports) an existing key from a PKCS#11 token using C_WrapKey. The encrypted key material is stored as a computed attribute.
---

# pkcs11_wrapped_key (Resource)

Wraps (exports) an existing key from a PKCS#11 token using C_WrapKey. The encrypted key material is stored as a computed attribute.

## Example Usage

```terraform
# Wrap an AES key for export using AES Key Wrap (RFC 3394)
resource "pkcs11_symmetric_key" "wrapping_key" {
  mechanism   = "CKM_AES_KEY_GEN"
  label       = "my-wrapping-key"
  class       = "CKO_SECRET_KEY"
  key_type    = "CKK_AES"
  value_len   = 32
  token       = true
  sensitive   = true
  extractable = false
  wrap        = true
  unwrap      = true
}

resource "pkcs11_symmetric_key" "target_key" {
  mechanism   = "CKM_AES_KEY_GEN"
  label       = "key-to-export"
  class       = "CKO_SECRET_KEY"
  key_type    = "CKK_AES"
  value_len   = 16
  encrypt     = true
  decrypt     = true
  token       = true
  sensitive   = true
  extractable = true
}

resource "pkcs11_wrapped_key" "wrapped" {
  mechanism          = "CKM_AES_KEY_WRAP"
  wrapping_key_label = pkcs11_symmetric_key.wrapping_key.label
  key_label          = pkcs11_symmetric_key.target_key.label
}

output "wrapped_key_material" {
  value     = pkcs11_wrapped_key.wrapped.wrapped_key_material
  sensitive = true
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `key_label` (String) Label of the key to wrap.
- `mechanism` (String) Wrapping mechanism name (e.g., CKM_AES_KEY_WRAP). Accepts name with or without CKM_ prefix, or numeric value.
- `wrapping_key_label` (String) Label of the wrapping key on the token.

### Optional

- `key_class` (String) Object class of the key to wrap (default: CKO_SECRET_KEY).
- `wrapping_key_class` (String) Object class of the wrapping key (default: CKO_SECRET_KEY).

### Read-Only

- `id` (String) Resource identifier.
- `wrapped_key_material` (String, Sensitive) The wrapped (encrypted) key material, base64-encoded.
