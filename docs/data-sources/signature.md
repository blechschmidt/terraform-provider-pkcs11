---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "pkcs11_signature Data Source - pkcs11"
subcategory: ""
description: |-
  Signs data using a key on the PKCS#11 token via C_SignInit + C_Sign.
---

# pkcs11_signature (Data Source)

Signs data using a key on the PKCS#11 token via C_SignInit + C_Sign.

## Example Usage

```terraform
# Sign data with an RSA private key
data "pkcs11_signature" "rsa" {
  mechanism = "CKM_SHA256_RSA_PKCS"
  key_label = "my-signing-key"
  data      = base64encode("message to sign")
}

output "rsa_signature" {
  value = data.pkcs11_signature.rsa.signature
}

# Sign data with an EC private key
data "pkcs11_signature" "ecdsa" {
  mechanism = "CKM_ECDSA"
  key_label = "my-ec-key"
  key_class = "CKO_PRIVATE_KEY"
  data      = base64encode("message to sign")
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `data` (String) Base64-encoded data to sign.
- `key_label` (String) Label of the signing key on the token.
- `mechanism` (String) PKCS#11 mechanism name (e.g. CKM_RSA_PKCS, CKM_ECDSA). Accepts CKM_ prefix or without.

### Optional

- `key_class` (String) Object class of the key (e.g. CKO_PRIVATE_KEY). Defaults to CKO_PRIVATE_KEY.
- `mechanism_parameter` (String) Base64-encoded mechanism parameter.

### Read-Only

- `signature` (String) Base64-encoded signature result.
